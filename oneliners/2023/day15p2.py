print((lambda h, d = [{} for _ in range(256)]: [[d.__setitem__(h(item[:-1]), {k: v for k, v in d[h(item[:-1])].items() if k != item[:-1]}) if "-" in item else d[h(item[:-2])].__setitem__(item[:-2], int(item[-1])) for item in input().split(",")], sum(i * j * n for i, b in enumerate(d, 1) for j, n in enumerate(b.values(), 1))][-1])(lambda s: sum(17 ** i * ord(ch) % 256 for i, ch in enumerate(s[::-1], 1)) % 256))
