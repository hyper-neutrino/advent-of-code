print((lambda grid, q = [(0, -1, 0, 1)], seen = {(0, -1, 0, 1)}: [(lambda add: [(lambda ch: add(r + dr, c + dc, dr, dc) if ch == "." or ch == "-" and dc or ch == "|" and dr else add(r + dc, c + dr, dc, dr) if ch == "\\" else add(r - dc, c - dr, -dc, -dr) if ch == "/" else (add(r - 1, c, -1, 0), add(r + 1, c, 1, 0)) if ch == "|" else (add(r, c - 1, 0, -1), add(r, c + 1, 0, 1)))(grid[r][c]) for r, c, dr, dc in q])(lambda r, c, dr, dc: 0 <= r < len(grid) and 0 <= c < len(grid[0]) and (r, c, dr, dc) not in seen and [q.append((r, c, dr, dc)), seen.add((r, c, dr, dc))]), len({(r, c) for r, c, _, _ in seen} - {(0, -1)})][-1])(open(0).read().splitlines()))
