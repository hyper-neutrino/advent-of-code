print((lambda s, m: (lambda f: f(f, s, m))(lambda f, s, m: min(s)[0] if len(m) == 0 else f(f, (lambda a: [[(lambda q: a.append((rs, re)) if len(q) == 0 else (lambda ds, ts, te: [a.append((max(rs, ts) + ds - ts, min(re, te) + ds - ts)), s.append((rs, ts)) if ts > rs else 0, s.append((te, re)) if re > te else 0])(q[0][0], q[0][1], q[0][1] + q[0][2]))([(ds, ts, tl) for ds, ts, tl in m[0] if ts + tl > rs and re > ts]) for rs, re in s], a][1])([]), m[1:])))(*(lambda a, *b: ((lambda s: [(s[i], s[i] + s[i + 1]) for i in range(0, len(s), 2)])(list(map(int, a.split(":")[1].split()))), [[list(map(int, k.split())) for k in x.splitlines()[1:]] for x in b]))(*open(0).read().split("\n\n"))))
